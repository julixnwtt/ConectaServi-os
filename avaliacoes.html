<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Avalia√ß√µes ‚Äî ConectaServi√ßos</title>
  <link rel="icon" type="image/svg+xml" href="assets/img/favicon.svg">
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&display=swap" rel="stylesheet">
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
  <link rel="stylesheet" href="assets/css/estilos.css">
  <script src="assets/js/auth-guard.js"></script>
</head>
<body class="layout-has-fixed-footer">
  <header id="site-header"></header>
  <main class="py-4">
    <div class="container">
      <h1 class="display-6 fw-bold mb-4 text-black">Avalia√ß√µes de Clientes</h1>

      <form class="row g-2 card-3d p-3 mb-4">
        <div class="col-sm-6 col-lg-4">
          <label class="form-label">Categoria</label>
          <select class="form-select form-3d" id="rCategoria"></select>
        </div>
        
        <div class="col-sm-6 col-lg-4">
          <label class="form-label">Classifica√ß√£o m√≠nima</label>
          <select class="form-select form-3d" id="rMin">
            <option value="0">Todas</option>
            <option value="3">‚òÖ 3.0+</option>
            <option value="4">‚òÖ 4.0+</option>
            <option value="4.5">‚òÖ 4.5+</option>
          </select>
        </div>
        
        <div class="col-sm-6 col-lg-4 d-flex align-items-end">
          <button type="button" class="btn btn-brand btn-3d w-100" id="btnFiltrarAvaliacao">Mostrar</button>
        </div>
      </form>

      <div class="row g-4" id="reviewsList">
        <div class="col-md-6 review" data-cat="Diarista" data-stars="4.8" id="ana-lima">
          <article class="card card-3d h-100">
            <div class="card-body">
              <div class="d-flex justify-content-between">
                <h3 class="h6 mb-1">Ana Lima ‚Äî Diarista</h3>
                <div class="stars" data-stars="4.8"></div>
              </div>
              <p class="text-secondary small mb-2">Indaiatuba, SP</p>
              <p>"Pontual, caprichosa e organizada. Meu apartamento ficou impec√°vel."</p>
              <ul class="small text-secondary mb-0">
                <li>Servi√ßo: limpeza completa</li>
                <li>Dura√ß√£o: 5h ‚Ä¢ Valor: R$ 150</li>
              </ul>
            </div>
          </article>
        </div>
        <div class="col-md-6 review" data-cat="Jardineiro" data-stars="4.6" id="joao-pereira">
          <article class="card card-3d h-100">
            <div class="card-body">
              <div class="d-flex justify-content-between">
                <h3 class="h6 mb-1">Jo√£o Pereira ‚Äî Jardineiro</h3>
                <div class="stars" data-stars="4.6"></div>
              </div>
              <p class="text-secondary small mb-2">S√£o Paulo, SP</p>
              <p>"Cuidou do jardim e sugeriu um paisagismo simples que deu outra vida ao quintal."</p>
              <ul class="small text-secondary mb-0">
                <li>Servi√ßo: poda e paisagismo</li>
                <li>Dura√ß√£o: 1 dia ‚Ä¢ Valor: R$ 350</li>
              </ul>
            </div>
          </article>
        </div>

        <div class="col-md-6 review" data-cat="Bab√°" data-stars="4.9" id="mariana-souza">
          <article class="card card-3d h-100">
            <div class="card-body">
              <div class="d-flex justify-content-between">
                <h3 class="h6 mb-1">Mariana Souza ‚Äî Bab√°</h3>
                <div class="stars" data-stars="4.9"></div>
              </div>
              <p class="text-secondary small mb-2">Curitiba, PR</p>
              <p>"Carinhosa e atenta. Passa muita confian√ßa e tem curso de primeiros socorros."</p>
              <ul class="small text-secondary mb-0">
                <li>Servi√ßo: per√≠odo noturno</li>
                <li>Dura√ß√£o: 2 noites ‚Ä¢ Valor: R$ 300</li>
              </ul>
            </div>
          </article>
        </div>
      </div>
    </div>
  </main><footer class="site-footer">
  <div class="footer-shell">
    <div class="footer-wave"></div>
    <div class="container footer-main">
      <div class="row align-items-start g-3">
        <div class="col-md-4">
          <div class="footer-brand">
            <span class="fw-bold">Conecta<span class="text-orange">Servi√ßos</span></span>
          </div>
          <p class="mb-1 text-light-blue">Conectando clientes a profissionais qualificados</p>
          <div class="d-flex gap-3 small">
            <a href="landing-ajuda.html#central">Ajuda</a>
            <a href="landing-legal.html#termos">Legal</a>
          </div>
        </div>
        <div class="col-md-5">
          <div class="footer-links">
            <div class="col">
              <div class="fw-semibold">Explorar</div>
              <a href="como-funciona.html" class="d-block">Como funciona</a>
              <a href="profissionais.html" class="d-block">Profissionais</a>
              <a href="avaliacoes.html" class="d-block">Avalia√ß√µes</a>
            </div>
            <div class="col">
              <div class="fw-semibold">Cadastros</div>
              <a href="cadastro-cliente.html" class="d-block">Como Cliente</a>
              <a href="cadastro-prestador.html" class="d-block">Como Prestador</a>
            </div>
            <div class="col">
              <div class="fw-semibold">Legal</div>
              <a href="landing-legal.html#termos" class="d-block">Termos</a>
              <a href="landing-legal.html#privacidade" class="d-block">Privacidade</a>
              <a href="landing-legal.html#cookies" class="d-block">Cookies</a>
            </div>
          </div>
        </div>
      </div>
    </div>
    <div class="footer-bottom">
      <div class="container d-flex justify-content-between small">
        <div>¬© <span id="y"></span> ConectaServi√ßos</div>
        <div class="d-none d-sm-block">Indaiatuba, SP</div>
      </div>
    </div>
  </div>
</footer>
<div class="cookie-banner">
  <div class="cookie-content">
    <div class="cookie-text">
      <h4>üç™ Ei, sobre cookies!</h4>
      <p>A gente usa cookies para melhorar sua experi√™ncia e lembrar suas prefer√™ncias. Ao aceitar, voc√™ concorda com nossa <a href="landing-legal.html#cookies">Pol√≠tica de Cookies</a>.</p>
    </div>
    <div class="cookie-buttons">
      <button id="btnAcceptCookies" class="btn btn-brand btn-3d">Aceitar</button>
      <button id="btnDeclineCookies" class="btn btn-outline-brand btn-3d">Recusar</button>
    </div>
  </div>
</div>
<script src="https://code.jquery.com/jquery-3.7.1.min.js"></script><script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script><script src="assets/js/scripts.js"></script>
<script>
  // Carrega avalia√ß√µes do servidor
  async function carregarAvaliacoes() {
    try {
      const response = await fetch('http://localhost:3000/avaliacoes');
      const data = await response.json();
      
      if (data.success && data.avaliacoes.length > 0) {
        const reviewsList = document.getElementById('reviewsList');
        reviewsList.innerHTML = ''; // Limpa conte√∫do existente
        
        data.avaliacoes.forEach(avaliacao => {
          const prestadorNome = avaliacao.prestador?.nome || 'Profissional';
          const prestadorProfissao = avaliacao.prestador?.profissao || 'Prestador';
          const clienteNome = avaliacao.cliente?.nome || 'Cliente';
          const nota = avaliacao.nota || 0;
          const comentario = avaliacao.comentario || '';
          const servico = avaliacao.servico || 'Servi√ßo';
          const data_formatada = new Date(avaliacao.data).toLocaleDateString('pt-BR');
          
          const iniciais = prestadorNome.split(' ').map(n => n[0]).join('').substring(0, 2).toUpperCase();
          
          const card = `
            <div class="col-md-6 review" data-cat="${prestadorProfissao}" data-stars="${nota}">
              <article class="card card-3d h-100">
                <div class="card-body">
                  <div class="d-flex justify-content-between align-items-start mb-2">
                    <div>
                      <h3 class="h6 mb-1">${prestadorNome} ‚Äî ${prestadorProfissao}</h3>
                      <div class="stars" data-stars="${nota}"></div>
                    </div>
                  </div>
                  <p class="text-secondary small mb-2">Avaliado por: ${clienteNome}</p>
                  <p>"${comentario}"</p>
                  <ul class="small text-secondary mb-0">
                    <li>Servi√ßo: ${servico}</li>
                    <li>Data: ${data_formatada}</li>
                  </ul>
                </div>
              </article>
            </div>
          `;
          
          reviewsList.innerHTML += card;
        });
        
        // Reinicializa as estrelas ap√≥s adicionar novos cards
        if (typeof window.initStars === 'function') {
          initStars();
        }
      }
    } catch (error) {
      // Servidor n√£o dispon√≠vel, usando dados est√°ticos
    }
  }
  
  // Carrega avalia√ß√µes quando a p√°gina carregar
  document.addEventListener('DOMContentLoaded', carregarAvaliacoes);
</script>
</body></html>